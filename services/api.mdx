---
title: API
description: Overview of the Genji Parkour API service and how it fits into the broader infrastructure.
---

<Info>
The Genji Shimada API is the primary backend service powering the Genji Parkour ecosystem.  
It exposes REST endpoints for maps, users, completions, playtests, ranking, lootboxes, and more.
</Info>

## What the API Does

The API is responsible for:

- Serving all public and internal REST endpoints under `/api/v3`
- Validating input using typed models from `genjipk-sdk`
- Acting as the authoritative interface to the PostgreSQL database
- Publishing events to RabbitMQ (XP, playtests, completions, notifications)
- Powering:
  - The Discord bot
  - The Genji Parkour web clients
  - Internal admin tools
  - Automation services

## Technologies Used

- **Litestar** for async HTTP routing
- **asyncpg** for high-performance Postgres access
- **aio-pika** + RabbitMQ for async job publishing
- **msgspec** for fast JSON serialization and request validation
- **Sentry** for error tracking
- **Docker** for local and production deployment

## Code Organization (High-Level)

| Area | Purpose |
|------|---------|
| `app.py` | Creates and configures the Litestar application |
| `routes/` | Controllers + routers for each domain feature |
| `di/` | Dependency-injected service layer (UserService, MapService, etc.) |
| `middleware/auth.py` | API key authentication via `X-API-KEY` |
| `utilities/` | Shared helpers, exception wrappers, SQL utilities |
| `html/` | Optional static site bundle served at `/` |

## Why This Architecture?

- **Separation of concerns**  
  Controllers handle HTTP details; services handle domain logic.

- **Typed external SDK**  
  Using `genjipk-sdk` ensures the bot, API, and web clients all share the same DTOs.

- **Dynamic routing**  
  Adding a new feature requires *only* adding a file inside `routes/`—no global registration.

- **Async everywhere**  
  Ensures the API stays responsive under high load (queue workers + website + bot activity).

## Dependencies on Other Services

- **Database (Postgres)** — persistent data store  
- **RabbitMQ** — async job queue for XP, completions, rank updates, notifications  
- **OCR** — used indirectly through completion submission  
- **Bot** — consumes API events and publishes some back into the system

## Related Pages

- <Link href="/api/overview">API Overview</Link>  
- <Link href="/api/local-dev">Local Development</Link>  
- <Link href="/api/deployment">Deployment</Link>  
- <Link href="/api/architecture">Architecture & Patterns</Link>
